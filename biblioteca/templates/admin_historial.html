<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historial de préstamos</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="admin-container">
        <div style="text-align:center;">
            <img src="{{ url_for('static', filename='escudo.jpg') }}" alt="Escudo" style="width:60px; margin-bottom:10px;">
            <h2>Historial de Préstamos</h2>
            <hr>
        </div>
        <form method="GET" action="{{ url_for('admin_historial') }}" style="text-align:center; margin-bottom:20px;">
            <input type="text" name="search" placeholder="Buscar por nombre, correo, libro, código o fecha" value="{{ search }}">
            <button type="submit">Buscar</button>
        </form>
        <div class="table-section">
            <div style="overflow-x:auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Código Libro</th>
                            <th>Libro</th>
                            <th>Nombre</th>
                            <th>Correo</th>
                            <th>Grado</th>
                            <th>Curso</th>
                            <th>Fecha Préstamo</th>
                            <th>Días Solicitados</th>
                            <th>Fecha Devolución</th>
                            <th>Devuelto</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for prestamo in prestamos %}
                        <tr>
                            <td data-label="Código Libro">{{ prestamo['codigo_libro'] }}</td>
                            <td data-label="Libro">{{ prestamo['libro'] }}</td>
                            <td data-label="Nombre">{{ prestamo['nombre'] }}</td>
                            <td data-label="Correo">{{ prestamo['correo'] }}</td>
                            <td data-label="Grado">{{ prestamo['grado'] }}</td>
                            <td data-label="Curso">{{ prestamo['curso'] }}</td>
                            <td data-label="Fecha Préstamo">{{ prestamo['fecha_prestamo'] }}</td>
                            <td data-label="Días Solicitados">{{ prestamo['dias'] }}</td>
                            <td data-label="Fecha Devolución">{{ prestamo['fecha_devolucion'] if prestamo['fecha_devolucion'] else '' }}</td>
                            <td data-label="Devuelto">
                                {% if prestamo['devuelto'] == 1 %}
                                    <span style="color:green;">Sí</span>
                                {% else %}
                                    <span style="color:red;">No</span>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        <div style="text-align:center; margin-top:20px;">
            <a href="{{ url_for('admin_panel') }}"><button>Volver al panel</button></a>
        </div>
    </div>
</body>
</html>